<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Project 5</title>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.7.8/handlebars.min.js"></script>




  </head>
  <body style='margin-left: 30px;'>

    <div class="container">

      <div id="majorTable"></div>

        <h1>Select a Major</h1>

          <button type='button' class="btn btn-primary" onClick="getData('CIT')">CIT Majors</button>
          <button type='button' class="btn btn-primary" onClick="getData('BUS')">Business Majors</button>

        <h2>We filter our dataset by major</h2>

    </div>
  </body>

  <!-- html displayed stuff -->




  <script id="chart" type="text/x-handlebars-template" id="majorTemplate">

  <!-- declare handlebars -->


  <table class="table table-striped">
     <tr><th>Name</th><th>Major</th><th>Midterm</th><th>Final</th></tr>
     {{#each rows}}
        <tr>
           <td>{{name}}</td><td>{{major}}</td><td>{{midterm}}</td><td>{{final}}</td>
        </tr>
     {{/each}}
  </table>
</script>

<!-- handlebars template -->

<script>
async function getData(selectedMajor) {
    var response = await fetch('cit5students.json');   // this is a GET request

    if(response.ok) {
        var data = await response.json();

        // filter data array for the selected meal
        majorData = data.filter( (item) => item.name == selectedMajor );

       var templateText = document.getElementById('majorTemplate').innerHTML;
       var compiledTemplateText = Handlebars.compile(templateText);   // get and compile template code
       compiledHtml = compiledTemplateText({ rows: majorData })      // apply data to template
       document.getElementById('majorTable').innerHTML = compiledHtml;
    }
    else {
       document.querySelector('#majorTable').innerHTML = "There was an error, or menu items not found";
    }

}
</script>



</html>
